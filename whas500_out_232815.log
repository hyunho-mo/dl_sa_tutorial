deepsurv toturial
torch.cuda.is_available() True
Checker
      id  age  gender   hr  sysbp  ...  av3  miord  mitype  lenfol  fstat
0      1   83       0   89    152  ...    0      1       0    2178      0
1      2   49       0   84    120  ...    0      0       1    2172      0
2      3   70       1   83    147  ...    0      0       1    2190      0
3      4   70       0   65    123  ...    0      0       1     297      1
4      5   70       0   63    135  ...    0      0       1    2131      0
..   ...  ...     ...  ...    ...  ...  ...    ...     ...     ...    ...
495  496   76       1   68    112  ...    0      0       1      10      1
496  497   76       1   88    208  ...    0      0       0     662      0
497  498   57       1  123    120  ...    0      0       0     725      0
498  499   67       0   59    112  ...    0      0       1     532      0
499  500   98       0   99    160  ...    0      0       1     259      1

[500 rows x 16 columns]
Training CPH Model
<lifelines.CoxPHFitter: fitted with 400 total observations, 225 right-censored observations>
             duration col = 'time'
                event col = 'censor'
      baseline estimation = breslow
   number of observations = 400
number of events observed = 175
   partial log-likelihood = -871.43
         time fit was run = 2023-08-04 09:44:17 UTC

---
     coef  exp(coef)   se(coef)   coef lower 95%   coef upper 95%  exp(coef) lower 95%  exp(coef) upper 95%
0    0.05       1.06       0.01             0.04             0.07                 1.04                 1.07
1   -0.24       0.79       0.16            -0.55             0.07                 0.58                 1.08
2    0.01       1.01       0.00             0.00             0.02                 1.00                 1.02
3    0.00       1.00       0.00            -0.00             0.01                 1.00                 1.01
4   -0.01       0.99       0.01            -0.02            -0.00                 0.98                 1.00
5   -0.05       0.96       0.02            -0.08            -0.01                 0.92                 0.99
6   -0.01       0.99       0.20            -0.41             0.39                 0.66                 1.48
7   -0.08       0.92       0.19            -0.45             0.29                 0.64                 1.34
8    1.11       3.05       0.30             0.52             1.71                 1.68                 5.53
9    0.66       1.94       0.17             0.33             1.00                 1.39                 2.71
10   0.43       1.54       0.43            -0.41             1.27                 0.66                 3.57
11   0.07       1.08       0.17            -0.26             0.40                 0.77                 1.50
12  -0.20       0.82       0.21            -0.60             0.20                 0.55                 1.22

       z      p   -log2(p)
0   6.60 <0.005      34.52
1  -1.50   0.13       2.90
2   3.27 <0.005       9.88
3   0.72   0.47       1.09
4  -2.28   0.02       5.45
5  -2.48   0.01       6.26
6  -0.05   0.96       0.06
7  -0.43   0.67       0.58
8   3.67 <0.005      11.99
9   3.90 <0.005      13.32
10  1.00   0.31       1.67
11  0.43   0.67       0.58
12 -0.98   0.33       1.60
---
Concordance = 0.78
Log-likelihood ratio test = 180.23 on 13 df, -log2(p)=102.38

Train Likelihood: -871.4349575528948
Test metrics: {'c_index': 0.7867593269934162, 'c_index_bootstrap': {'mean': 0.7903831296256004, 'confidence_interval': (0.7829412014476482, 0.7978250578035526)}}
ci_rsf 0.7670080468178493
################### Theano DeepSurv evaluation ###################
Loading json model: {"learning_rate": 0.015594096518941305, "dropout": 0.014743652343750002, "lr_decay": 0.0006419482421875, "momentum": 0.863554443359375, "L2_reg": 1.574680908203125, "batch_norm": false, "standardize": true, "n_in": 13, "hidden_layers_sizes": [13], "activation": "selu"}
2023-08-04 11:44:25,079 - Training step 0/300   |                         | - loss: 10.8800 - ci: 0.6168
2023-08-04 11:44:25,724 - Training step 10/300  |                         | - loss: 6.6399 - ci: 0.7740
2023-08-04 11:44:26,388 - Training step 20/300  |*                        | - loss: 5.6877 - ci: 0.7827
2023-08-04 11:44:26,988 - Training step 30/300  |**                       | - loss: 5.3362 - ci: 0.7815
2023-08-04 11:44:27,655 - Training step 40/300  |***                      | - loss: 5.1886 - ci: 0.7820
2023-08-04 11:44:28,343 - Training step 50/300  |****                     | - loss: 5.1031 - ci: 0.7866
2023-08-04 11:44:29,236 - Training step 60/300  |*****                    | - loss: 5.0636 - ci: 0.7896
2023-08-04 11:44:29,868 - Training step 70/300  |*****                    | - loss: 5.0452 - ci: 0.7907
2023-08-04 11:44:30,570 - Training step 80/300  |******                   | - loss: 5.0310 - ci: 0.7917
2023-08-04 11:44:31,255 - Training step 90/300  |*******                  | - loss: 5.0197 - ci: 0.7933
2023-08-04 11:44:31,905 - Training step 100/300 |********                 | - loss: 5.0047 - ci: 0.7940
2023-08-04 11:44:32,695 - Training step 110/300 |*********                | - loss: 5.0075 - ci: 0.7953
2023-08-04 11:44:33,288 - Training step 120/300 |**********               | - loss: 4.9932 - ci: 0.7957
2023-08-04 11:44:33,872 - Training step 130/300 |**********               | - loss: 4.9900 - ci: 0.7961
2023-08-04 11:44:34,462 - Training step 140/300 |***********              | - loss: 4.9867 - ci: 0.7970
2023-08-04 11:44:35,090 - Training step 150/300 |************             | - loss: 4.9732 - ci: 0.7971
2023-08-04 11:44:35,711 - Training step 160/300 |*************            | - loss: 4.9720 - ci: 0.7982
2023-08-04 11:44:36,577 - Training step 170/300 |**************           | - loss: 4.9693 - ci: 0.7981
2023-08-04 11:44:37,189 - Training step 180/300 |***************          | - loss: 4.9662 - ci: 0.7984
2023-08-04 11:44:37,853 - Training step 190/300 |***************          | - loss: 4.9542 - ci: 0.7994
2023-08-04 11:44:38,455 - Training step 200/300 |****************         | - loss: 4.9597 - ci: 0.7991
2023-08-04 11:44:39,107 - Training step 210/300 |*****************        | - loss: 4.9494 - ci: 0.7993
2023-08-04 11:44:39,881 - Training step 220/300 |******************       | - loss: 4.9579 - ci: 0.8001
2023-08-04 11:44:40,476 - Training step 230/300 |*******************      | - loss: 4.9516 - ci: 0.8002
2023-08-04 11:44:41,078 - Training step 240/300 |********************     | - loss: 4.9502 - ci: 0.8001
2023-08-04 11:44:41,676 - Training step 250/300 |********************     | - loss: 4.9528 - ci: 0.8004
2023-08-04 11:44:42,277 - Training step 260/300 |*********************    | - loss: 4.9476 - ci: 0.8007
2023-08-04 11:44:42,868 - Training step 270/300 |**********************   | - loss: 4.9578 - ci: 0.8013
2023-08-04 11:44:43,638 - Training step 280/300 |***********************  | - loss: 4.9387 - ci: 0.8010
2023-08-04 11:44:44,237 - Training step 290/300 |************************ | - loss: 4.9319 - ci: 0.8009
2023-08-04 11:44:44,779 - Finished Training with 300 iterations in 19.94s
Training metrics: {'c_index': 0.8009655340992422}
Test metrics: {'c_index': 0.7772494513533285, 'c_index_bootstrap': {'mean': 0.786904977924399, 'confidence_interval': (0.779440883755213, 0.7943690720935849)}}
=> load 320 samples
=> load 400 samples
=> load 100 samples
{'train': {'epochs': 300, 'learning_rate': 0.0010971687705663455, 'lr_decay_rate': 0.000299873046875, 'optimizer': 'Adam'}, 'network': {'drop': 0.4892822265625, 'norm': True, 'dims': [13, 53, 53, 1], 'activation': 'ReLU', 'l2_reg': 0.28053271484374986}}
Epoch: 1	Loss: 6.98930836(6.87322712)	c-index: 0.53296200(0.50000000)	lr: 0.00109684  
flag:  1
Epoch: 2	Loss: 7.10735369(6.86037159)	c-index: 0.50350290(0.50000000)	lr: 0.00109651  
flag:  2
Epoch: 3	Loss: 7.12245417(6.84831810)	c-index: 0.50145165(0.50000000)	lr: 0.00109618  
Epoch: 4	Loss: 6.91008234(6.83511877)	c-index: 0.57158861(0.53646215)	lr: 0.00109585  
Epoch: 5	Loss: 6.98695564(6.81699896)	c-index: 0.51981823(0.65082906)	lr: 0.00109553  
Epoch: 6	Loss: 6.86794138(6.79652405)	c-index: 0.58619982(0.67619979)	lr: 0.0010952  
flag:  1
Epoch: 7	Loss: 6.84304285(6.77658558)	c-index: 0.55798725(0.67383688)	lr: 0.00109487  
flag:  2
Epoch: 8	Loss: 6.85505724(6.75791836)	c-index: 0.55186506(0.67364336)	lr: 0.00109454  
flag:  3
Epoch: 9	Loss: 6.78996325(6.73804855)	c-index: 0.58945027(0.67506926)	lr: 0.00109422  
flag:  4
Epoch: 10	Loss: 6.74479628(6.71885586)	c-index: 0.60647564(0.67474334)	lr: 0.00109389  
flag:  5
Epoch: 11	Loss: 6.73965788(6.69886923)	c-index: 0.59552512(0.67506926)	lr: 0.00109356  
Epoch: 12	Loss: 6.70513105(6.67849827)	c-index: 0.58915047(0.67835900)	lr: 0.00109323  
Epoch: 13	Loss: 6.65094995(6.65748644)	c-index: 0.62944963(0.68144504)	lr: 0.00109291  
Epoch: 14	Loss: 6.68834066(6.63596630)	c-index: 0.62230182(0.68362462)	lr: 0.00109258  
Epoch: 15	Loss: 6.65843725(6.61403084)	c-index: 0.61535913(0.68598753)	lr: 0.00109226  
Epoch: 16	Loss: 6.60261011(6.59348488)	c-index: 0.63173757(0.68767824)	lr: 0.00109193  
Epoch: 17	Loss: 6.58013678(6.57283545)	c-index: 0.63767041(0.69063187)	lr: 0.0010916  
Epoch: 18	Loss: 6.70248890(6.55286360)	c-index: 0.61696857(0.69262813)	lr: 0.00109128  
Epoch: 19	Loss: 6.61336040(6.53162670)	c-index: 0.60787995(0.69345311)	lr: 0.00109095  
Epoch: 20	Loss: 6.51298475(6.51123524)	c-index: 0.64762686(0.69547992)	lr: 0.00109063  
Epoch: 21	Loss: 6.52662563(6.49134636)	c-index: 0.64519692(0.69681414)	lr: 0.0010903  
Epoch: 22	Loss: 6.53058195(6.47196484)	c-index: 0.63169023(0.69839281)	lr: 0.00108998  
Epoch: 23	Loss: 6.46330070(6.45177698)	c-index: 0.64333502(0.70059276)	lr: 0.00108965  
Epoch: 24	Loss: 6.39384651(6.43127728)	c-index: 0.67695973(0.70270105)	lr: 0.00108933  
Epoch: 25	Loss: 6.44818115(6.41187096)	c-index: 0.65912964(0.70538988)	lr: 0.001089  
Epoch: 26	Loss: 6.45270872(6.39144039)	c-index: 0.62053459(0.70719262)	lr: 0.00108868  
Epoch: 27	Loss: 6.39385796(6.37055206)	c-index: 0.67721219(0.70926016)	lr: 0.00108836  
Epoch: 28	Loss: 6.33717012(6.35225821)	c-index: 0.66806046(0.71033977)	lr: 0.00108803  
Epoch: 29	Loss: 6.31600046(6.33290911)	c-index: 0.68062042(0.71242769)	lr: 0.00108771  
Epoch: 30	Loss: 6.39524460(6.31372833)	c-index: 0.64470778(0.71367025)	lr: 0.00108739  
Epoch: 31	Loss: 6.28266382(6.29592943)	c-index: 0.68915678(0.71477023)	lr: 0.00108706  
Epoch: 32	Loss: 6.27050829(6.27538776)	c-index: 0.66859695(0.71573780)	lr: 0.00108674  
Epoch: 33	Loss: 6.29289532(6.25642586)	c-index: 0.67151603(0.71605353)	lr: 0.00108642  
Epoch: 34	Loss: 6.30473614(6.23659611)	c-index: 0.65632100(0.71774424)	lr: 0.0010861  
Epoch: 35	Loss: 6.24832201(6.21873999)	c-index: 0.67714908(0.71963864)	lr: 0.00108577  
Epoch: 36	Loss: 6.24717951(6.19912243)	c-index: 0.65580030(0.72034140)	lr: 0.00108545  
Epoch: 37	Loss: 6.24593878(6.18008995)	c-index: 0.67263633(0.72164507)	lr: 0.00108513  
flag:  1
Epoch: 38	Loss: 6.20238495(6.16037703)	c-index: 0.69914479(0.72142101)	lr: 0.00108481  
flag:  2
Epoch: 39	Loss: 6.21156168(6.14315796)	c-index: 0.67574476(0.72122749)	lr: 0.00108449  
Epoch: 40	Loss: 6.17919779(6.12600803)	c-index: 0.66802891(0.72273487)	lr: 0.00108416  
Epoch: 41	Loss: 6.17767048(6.10765171)	c-index: 0.67814315(0.72434409)	lr: 0.00108384  
Epoch: 42	Loss: 6.09843206(6.08812952)	c-index: 0.70263191(0.72495519)	lr: 0.00108352  
flag:  1
Epoch: 43	Loss: 6.06428909(6.07062912)	c-index: 0.70839119(0.72400799)	lr: 0.0010832  
Epoch: 44	Loss: 6.12058163(6.05271912)	c-index: 0.68284524(0.72576998)	lr: 0.00108288  
Epoch: 45	Loss: 6.06432819(6.03689051)	c-index: 0.71569679(0.72705329)	lr: 0.00108256  
Epoch: 46	Loss: 6.04412794(6.01930332)	c-index: 0.70551944(0.72805141)	lr: 0.00108224  
Epoch: 47	Loss: 5.99453449(6.00152922)	c-index: 0.72664731(0.72935509)	lr: 0.00108192  
Epoch: 48	Loss: 5.97953367(5.98381138)	c-index: 0.72847766(0.73012915)	lr: 0.0010816  
Epoch: 49	Loss: 6.04974699(5.96642971)	c-index: 0.68808382(0.73100505)	lr: 0.00108128  
Epoch: 50	Loss: 5.98143387(5.94926071)	c-index: 0.69679374(0.73225780)	lr: 0.00108096  
Epoch: 51	Loss: 5.97362375(5.93297529)	c-index: 0.70895923(0.73367351)	lr: 0.00108064  
Epoch: 52	Loss: 5.98007917(5.91578722)	c-index: 0.68846251(0.73464108)	lr: 0.00108032  
Epoch: 53	Loss: 5.92529488(5.89904356)	c-index: 0.71596503(0.73517070)	lr: 0.00108  
Epoch: 54	Loss: 5.88613749(5.88287497)	c-index: 0.71250947(0.73701418)	lr: 0.00107969  
Epoch: 55	Loss: 5.86072445(5.86620522)	c-index: 0.72382290(0.73760491)	lr: 0.00107937  
Epoch: 56	Loss: 5.89435339(5.84984112)	c-index: 0.71421358(0.73877618)	lr: 0.00107905  
Epoch: 57	Loss: 5.88013506(5.83280611)	c-index: 0.71837920(0.73956042)	lr: 0.00107873  
Epoch: 58	Loss: 5.87904787(5.81726599)	c-index: 0.70869099(0.74003911)	lr: 0.00107841  
Epoch: 59	Loss: 5.86030197(5.79961491)	c-index: 0.68320815(0.74056873)	lr: 0.00107809  
Epoch: 60	Loss: 5.80482912(5.78278160)	c-index: 0.71823719(0.74134278)	lr: 0.00107778  
Epoch: 61	Loss: 5.85279703(5.76617527)	c-index: 0.68585900(0.74364459)	lr: 0.00107746  
Epoch: 62	Loss: 5.74689388(5.75064230)	c-index: 0.74136897(0.74424550)	lr: 0.00107714  
Epoch: 63	Loss: 5.79557180(5.73454809)	c-index: 0.70757069(0.74525381)	lr: 0.00107683  
Epoch: 64	Loss: 5.76927614(5.71743584)	c-index: 0.70088046(0.74560010)	lr: 0.00107651  
Epoch: 65	Loss: 5.73136473(5.70000553)	c-index: 0.71634373(0.74582417)	lr: 0.00107619  
Epoch: 66	Loss: 5.68573570(5.68378973)	c-index: 0.72846188(0.74617046)	lr: 0.00107588  
Epoch: 67	Loss: 5.66194773(5.66603804)	c-index: 0.73964908(0.74690377)	lr: 0.00107556  
Epoch: 68	Loss: 5.66329288(5.64824200)	c-index: 0.73816587(0.74720932)	lr: 0.00107524  
Epoch: 69	Loss: 5.63772058(5.63216496)	c-index: 0.73030800(0.74761672)	lr: 0.00107493  
Epoch: 70	Loss: 5.62786531(5.61413097)	c-index: 0.74611840(0.74788153)	lr: 0.00107461  
Epoch: 71	Loss: 5.61787653(5.59939480)	c-index: 0.72140874(0.74870651)	lr: 0.0010743  
Epoch: 72	Loss: 5.57239389(5.58285284)	c-index: 0.73168076(0.74903243)	lr: 0.00107398  
Epoch: 73	Loss: 5.58891153(5.56564903)	c-index: 0.71831608(0.74940927)	lr: 0.00107367  
Epoch: 74	Loss: 5.56483030(5.54811287)	c-index: 0.74294686(0.75022407)	lr: 0.00107335  
Epoch: 75	Loss: 5.54455757(5.53021431)	c-index: 0.73660376(0.75045832)	lr: 0.00107304  
Epoch: 76	Loss: 5.52625227(5.51339960)	c-index: 0.73755049(0.75094720)	lr: 0.00107272  
Epoch: 77	Loss: 5.50615311(5.49675989)	c-index: 0.72795696(0.75185366)	lr: 0.00107241  
Epoch: 78	Loss: 5.53927708(5.48066711)	c-index: 0.70476206(0.75234254)	lr: 0.00107209  
Epoch: 79	Loss: 5.51500130(5.46459436)	c-index: 0.71557056(0.75264809)	lr: 0.00107178  
Epoch: 80	Loss: 5.50793028(5.44756174)	c-index: 0.71419780(0.75313697)	lr: 0.00107146  
Epoch: 81	Loss: 5.44886780(5.42964554)	c-index: 0.72757826(0.75362585)	lr: 0.00107115  
Epoch: 82	Loss: 5.51944971(5.41386938)	c-index: 0.73819742(0.75425731)	lr: 0.00107084  
Epoch: 83	Loss: 5.47482252(5.39777803)	c-index: 0.74750694(0.75470545)	lr: 0.00107052  
Epoch: 84	Loss: 5.36621046(5.38268328)	c-index: 0.74742805(0.75533692)	lr: 0.00107021  
Epoch: 85	Loss: 5.33633900(5.36541891)	c-index: 0.75609063(0.75566284)	lr: 0.0010699  
flag:  1
Epoch: 86	Loss: 5.40243101(5.34732246)	c-index: 0.72740470(0.75566284)	lr: 0.00106959  
Epoch: 87	Loss: 5.33369398(5.33166504)	c-index: 0.75408672(0.75627393)	lr: 0.00106927  
Epoch: 88	Loss: 5.37116528(5.31477308)	c-index: 0.72312863(0.75678318)	lr: 0.00106896  
Epoch: 89	Loss: 5.29673290(5.29775524)	c-index: 0.74340444(0.75737391)	lr: 0.00106865  
Epoch: 90	Loss: 5.28172493(5.28154087)	c-index: 0.75372381(0.75753687)	lr: 0.00106834  
Epoch: 91	Loss: 5.25290108(5.26633167)	c-index: 0.74602373(0.75756742)	lr: 0.00106802  
flag:  1
Epoch: 92	Loss: 5.26689577(5.25028372)	c-index: 0.73352689(0.75741465)	lr: 0.00106771  
Epoch: 93	Loss: 5.27598953(5.23478460)	c-index: 0.73065514(0.75784242)	lr: 0.0010674  
Epoch: 94	Loss: 5.26284170(5.21924973)	c-index: 0.72912459(0.75841278)	lr: 0.00106709  
Epoch: 95	Loss: 5.22153521(5.20560122)	c-index: 0.73920727(0.75896276)	lr: 0.00106678  
Epoch: 96	Loss: 5.21781206(5.18967485)	c-index: 0.74433540(0.75937016)	lr: 0.00106647  
Epoch: 97	Loss: 5.20962286(5.17449379)	c-index: 0.75216170(0.75968590)	lr: 0.00106616  
flag:  1
Epoch: 98	Loss: 5.14675665(5.16016674)	c-index: 0.75700581(0.75961460)	lr: 0.00106585  
Epoch: 99	Loss: 5.16860008(5.14583492)	c-index: 0.73707713(0.75971645)	lr: 0.00106554  
flag:  1
Epoch: 100	Loss: 5.07227135(5.13189602)	c-index: 0.76369604(0.75950257)	lr: 0.00106523  
Epoch: 101	Loss: 5.16261387(5.11667347)	c-index: 0.74439851(0.76134604)	lr: 0.00106492  
Epoch: 102	Loss: 5.11125755(5.10331583)	c-index: 0.74575549(0.76150900)	lr: 0.00106461  
Epoch: 103	Loss: 5.11616898(5.08884048)	c-index: 0.73974375(0.76163122)	lr: 0.0010643  
Epoch: 104	Loss: 5.10698366(5.07593203)	c-index: 0.72843032(0.76175344)	lr: 0.00106399  
Epoch: 105	Loss: 5.05101967(5.06062841)	c-index: 0.74379891(0.76201825)	lr: 0.00106368  
Epoch: 106	Loss: 5.13190603(5.04657555)	c-index: 0.72358622(0.76214047)	lr: 0.00106337  
Epoch: 107	Loss: 5.02463341(5.03156519)	c-index: 0.74152676(0.76244602)	lr: 0.00106306  
Epoch: 108	Loss: 5.01746416(5.01706266)	c-index: 0.74804342(0.76254787)	lr: 0.00106275  
Epoch: 109	Loss: 5.07042360(5.00060701)	c-index: 0.71891568(0.76297564)	lr: 0.00106244  
Epoch: 110	Loss: 4.96955299(4.98609304)	c-index: 0.75577506(0.76317934)	lr: 0.00106213  
Epoch: 111	Loss: 5.00284910(4.97096109)	c-index: 0.73000820(0.76338304)	lr: 0.00106182  
flag:  1
Epoch: 112	Loss: 4.93673420(4.95533419)	c-index: 0.74984221(0.76326082)	lr: 0.00106152  
Epoch: 113	Loss: 4.94795942(4.93934870)	c-index: 0.73628818(0.76342378)	lr: 0.00106121  
Epoch: 114	Loss: 4.91970873(4.92263460)	c-index: 0.74400404(0.76352563)	lr: 0.0010609  
Epoch: 115	Loss: 4.86886024(4.90701580)	c-index: 0.75736872(0.76521633)	lr: 0.00106059  
Epoch: 116	Loss: 4.88825464(4.89179564)	c-index: 0.74976332(0.76535892)	lr: 0.00106029  
Epoch: 117	Loss: 4.85796070(4.87693310)	c-index: 0.75784209(0.76552188)	lr: 0.00105998  
flag:  1
Epoch: 118	Loss: 4.85501623(4.86101055)	c-index: 0.74297841(0.76536910)	lr: 0.00105967  
flag:  2
Epoch: 119	Loss: 4.80927324(4.84244585)	c-index: 0.76005112(0.76483949)	lr: 0.00105937  
flag:  3
Epoch: 120	Loss: 4.82980585(4.82702208)	c-index: 0.75236683(0.76526725)	lr: 0.00105906  
flag:  4
Epoch: 121	Loss: 4.78647757(4.81181908)	c-index: 0.77384183(0.76552188)	lr: 0.00105875  
Epoch: 122	Loss: 4.77674007(4.79618740)	c-index: 0.75864681(0.76571539)	lr: 0.00105845  
Epoch: 123	Loss: 4.81044483(4.78213358)	c-index: 0.74455630(0.76636723)	lr: 0.00105814  
Epoch: 124	Loss: 4.72991943(4.76605988)	c-index: 0.74824855(0.76695796)	lr: 0.00105783  
Epoch: 125	Loss: 4.72373056(4.75118017)	c-index: 0.76262307(0.76751813)	lr: 0.00105753  
flag:  1
Epoch: 126	Loss: 4.70421076(4.73421478)	c-index: 0.75635887(0.76732462)	lr: 0.00105722  
Epoch: 127	Loss: 4.68077755(4.71827269)	c-index: 0.76697804(0.76926994)	lr: 0.00105692  
Epoch: 128	Loss: 4.69660044(4.70178080)	c-index: 0.74641820(0.76967734)	lr: 0.00105661  
Epoch: 129	Loss: 4.67399406(4.68650198)	c-index: 0.74507700(0.76977919)	lr: 0.00105631  
flag:  1
Epoch: 130	Loss: 4.66423130(4.67015028)	c-index: 0.76994446(0.76976901)	lr: 0.001056  
flag:  2
Epoch: 131	Loss: 4.65334082(4.65562725)	c-index: 0.75798409(0.76976901)	lr: 0.0010557  
Epoch: 132	Loss: 4.61383963(4.63934231)	c-index: 0.76656779(0.77001344)	lr: 0.00105539  
Epoch: 133	Loss: 4.60203648(4.62475157)	c-index: 0.75025246(0.77020696)	lr: 0.00105509  
Epoch: 134	Loss: 4.61270237(4.61033773)	c-index: 0.75531747(0.77032918)	lr: 0.00105478  
Epoch: 135	Loss: 4.58525038(4.59642076)	c-index: 0.75643777(0.77076713)	lr: 0.00105448  
flag:  1
Epoch: 136	Loss: 4.62410736(4.58127022)	c-index: 0.73535723(0.77066528)	lr: 0.00105418  
flag:  2
Epoch: 137	Loss: 4.57407618(4.56664276)	c-index: 0.76926597(0.77031899)	lr: 0.00105387  
flag:  3
Epoch: 138	Loss: 4.47215843(4.55279970)	c-index: 0.77564062(0.77023751)	lr: 0.00105357  
Epoch: 139	Loss: 4.47851038(4.53750324)	c-index: 0.77330535(0.77188748)	lr: 0.00105327  
flag:  1
Epoch: 140	Loss: 4.49423265(4.52460766)	c-index: 0.76464277(0.77176526)	lr: 0.00105296  
Epoch: 141	Loss: 4.42987156(4.51202726)	c-index: 0.78081608(0.77207081)	lr: 0.00105266  
Epoch: 142	Loss: 4.48737526(4.49832058)	c-index: 0.74698624(0.77217266)	lr: 0.00105236  
Epoch: 143	Loss: 4.51045609(4.48554611)	c-index: 0.74659177(0.77237635)	lr: 0.00105205  
Epoch: 144	Loss: 4.44823885(4.47179508)	c-index: 0.74951086(0.77288560)	lr: 0.00105175  
Epoch: 145	Loss: 4.38991070(4.45771551)	c-index: 0.77658735(0.77304856)	lr: 0.00105145  
Epoch: 146	Loss: 4.42523384(4.44456005)	c-index: 0.74906905(0.77335411)	lr: 0.00105115  
flag:  1
Epoch: 147	Loss: 4.36024761(4.43130255)	c-index: 0.77404696(0.77050232)	lr: 0.00105085  
flag:  2
Epoch: 148	Loss: 4.36120796(4.41824007)	c-index: 0.75927796(0.77095046)	lr: 0.00105054  
flag:  3
Epoch: 149	Loss: 4.35385704(4.40523672)	c-index: 0.75227215(0.77169396)	lr: 0.00105024  
flag:  4
Epoch: 150	Loss: 4.33672285(4.39254904)	c-index: 0.76756185(0.77174489)	lr: 0.00104994  
flag:  5
Epoch: 151	Loss: 4.33297157(4.38007545)	c-index: 0.76435875(0.77200970)	lr: 0.00104964  
flag:  6
Epoch: 152	Loss: 4.31107283(4.36621380)	c-index: 0.75454431(0.77233561)	lr: 0.00104934  
flag:  7
Epoch: 153	Loss: 4.34432507(4.35136414)	c-index: 0.75089939(0.77270227)	lr: 0.00104904  
flag:  8
Epoch: 154	Loss: 4.31281614(4.33866739)	c-index: 0.76601553(0.77272264)	lr: 0.00104874  
flag:  9
Epoch: 155	Loss: 4.31387854(4.32632637)	c-index: 0.76940798(0.77295690)	lr: 0.00104844  
flag:  10
Epoch: 156	Loss: 4.28399277(4.31331491)	c-index: 0.77108054(0.77322171)	lr: 0.00104814  
flag:  11
Epoch: 157	Loss: 4.21947098(4.30024004)	c-index: 0.77199571(0.77327263)	lr: 0.00104784  
Epoch: 158	Loss: 4.21229219(4.28708315)	c-index: 0.77300555(0.77413835)	lr: 0.00104754  
flag:  1
Epoch: 159	Loss: 4.27120495(4.27381754)	c-index: 0.74719137(0.77407724)	lr: 0.00104724  
flag:  2
Epoch: 160	Loss: 4.19728947(4.26131439)	c-index: 0.76999180(0.77373095)	lr: 0.00104694  
flag:  3
Epoch: 161	Loss: 4.22797489(4.24868774)	c-index: 0.75989334(0.77289579)	lr: 0.00104664  
flag:  4
Epoch: 162	Loss: 4.16555166(4.23480797)	c-index: 0.77026004(0.77366984)	lr: 0.00104634  
flag:  5
Epoch: 163	Loss: 4.16625452(4.22158623)	c-index: 0.76936064(0.77344578)	lr: 0.00104604  
flag:  6
Epoch: 164	Loss: 4.15502644(4.20770931)	c-index: 0.77201149(0.77348652)	lr: 0.00104574  
flag:  7
Epoch: 165	Loss: 4.19293785(4.19380093)	c-index: 0.74845367(0.77306893)	lr: 0.00104544  
flag:  8
Epoch: 166	Loss: 4.12577343(4.18027878)	c-index: 0.76874527(0.77294671)	lr: 0.00104514  
flag:  9
Epoch: 167	Loss: 4.11463356(4.16566277)	c-index: 0.77098586(0.77179581)	lr: 0.00104484  
flag:  10
Epoch: 168	Loss: 4.10408163(4.15151882)	c-index: 0.77647690(0.77120508)	lr: 0.00104455  
flag:  11
Epoch: 169	Loss: 4.08857298(4.13738871)	c-index: 0.76360136(0.77076713)	lr: 0.00104425  
flag:  12
Epoch: 170	Loss: 4.01095819(4.12307215)	c-index: 0.78332492(0.77014585)	lr: 0.00104395  
flag:  13
Epoch: 171	Loss: 3.99255848(4.10814190)	c-index: 0.79241353(0.77161248)	lr: 0.00104365  
flag:  14
Epoch: 172	Loss: 4.01213789(4.09406757)	c-index: 0.78889485(0.77323189)	lr: 0.00104335  
Epoch: 173	Loss: 4.01453257(4.07889223)	c-index: 0.77994825(0.77510592)	lr: 0.00104306  
Epoch: 174	Loss: 4.01347876(4.06469870)	c-index: 0.77160124(0.77655219)	lr: 0.00104276  
Epoch: 175	Loss: 3.96299553(4.04992914)	c-index: 0.77403118(0.77704107)	lr: 0.00104246  
flag:  1
Epoch: 176	Loss: 3.95000863(4.03593111)	c-index: 0.77467811(0.77646052)	lr: 0.00104217  
flag:  2
Epoch: 177	Loss: 3.98122072(4.02208090)	c-index: 0.76213393(0.77653182)	lr: 0.00104187  
flag:  3
Epoch: 178	Loss: 3.92151785(4.00921774)	c-index: 0.77936443(0.77700033)	lr: 0.00104157  
Epoch: 179	Loss: 3.93413210(3.99589705)	c-index: 0.76391694(0.77714292)	lr: 0.00104128  
Epoch: 180	Loss: 3.93127823(3.98383141)	c-index: 0.77164857(0.77868084)	lr: 0.00104098  
flag:  1
Epoch: 181	Loss: 3.85718846(3.97182178)	c-index: 0.78954178(0.77549295)	lr: 0.00104068  
flag:  2
Epoch: 182	Loss: 3.86536384(3.96023250)	c-index: 0.77736052(0.77559480)	lr: 0.00104039  
flag:  3
Epoch: 183	Loss: 3.84799314(3.94855165)	c-index: 0.77655579(0.77622627)	lr: 0.00104009  
flag:  4
Epoch: 184	Loss: 3.85961390(3.93811703)	c-index: 0.77745519(0.77652163)	lr: 0.0010398  
flag:  5
Epoch: 185	Loss: 3.83938146(3.92566562)	c-index: 0.77335269(0.77646052)	lr: 0.0010395  
flag:  6
Epoch: 186	Loss: 3.79727316(3.91420674)	c-index: 0.79317092(0.77595128)	lr: 0.00103921  
flag:  7
Epoch: 187	Loss: 3.80932570(3.90482807)	c-index: 0.78315135(0.77531981)	lr: 0.00103891  
flag:  8
Epoch: 188	Loss: 3.84377003(3.89537859)	c-index: 0.76087162(0.77697996)	lr: 0.00103862  
flag:  9
Epoch: 189	Loss: 3.81598568(3.88805842)	c-index: 0.77425208(0.77798827)	lr: 0.00103832  
flag:  10
Epoch: 190	Loss: 3.82099509(3.88151741)	c-index: 0.75847324(0.77054306)	lr: 0.00103803  
flag:  11
Epoch: 191	Loss: 3.79952788(3.87207675)	c-index: 0.76882416(0.77061436)	lr: 0.00103773  
flag:  12
Epoch: 192	Loss: 3.70396805(3.86248422)	c-index: 0.79593221(0.77135786)	lr: 0.00103744  
flag:  13
Epoch: 193	Loss: 3.76955342(3.85138750)	c-index: 0.77063873(0.77139860)	lr: 0.00103714  
flag:  14
Epoch: 194	Loss: 3.73873115(3.84003496)	c-index: 0.77459922(0.77058380)	lr: 0.00103685  
flag:  15
Epoch: 195	Loss: 3.70483899(3.82786894)	c-index: 0.78608622(0.77145971)	lr: 0.00103656  
flag:  16
Epoch: 196	Loss: 3.70331264(3.81528306)	c-index: 0.77480434(0.77253931)	lr: 0.00103626  
flag:  17
Epoch: 197	Loss: 3.67229438(3.80096698)	c-index: 0.78125789(0.77345596)	lr: 0.00103597  
flag:  18
Epoch: 198	Loss: 3.64245129(3.78657389)	c-index: 0.78785345(0.77459668)	lr: 0.00103568  
flag:  19
Epoch: 199	Loss: 3.67955494(3.77165842)	c-index: 0.77398384(0.77465779)	lr: 0.00103538  
flag:  20
Epoch: 200	Loss: 3.63664651(3.75727797)	c-index: 0.78515526(0.77478000)	lr: 0.00103509  
flag:  21
Epoch: 201	Loss: 3.64588737(3.74523568)	c-index: 0.77076496(0.77739754)	lr: 0.0010348  
Epoch: 202	Loss: 3.63606501(3.73429322)	c-index: 0.77456766(0.78154282)	lr: 0.0010345  
flag:  1
Epoch: 203	Loss: 3.60446501(3.72258353)	c-index: 0.79069364(0.78113542)	lr: 0.00103421  
Epoch: 204	Loss: 3.59878778(3.71118450)	c-index: 0.77188526(0.78210299)	lr: 0.00103392  
flag:  1
Epoch: 205	Loss: 3.61572742(3.70250034)	c-index: 0.77310023(0.78105394)	lr: 0.00103363  
flag:  2
Epoch: 206	Loss: 3.59083343(3.69618177)	c-index: 0.77245329(0.77389391)	lr: 0.00103334  
flag:  3
Epoch: 207	Loss: 3.57013202(3.69243073)	c-index: 0.77745519(0.77275320)	lr: 0.00103304  
flag:  4
Epoch: 208	Loss: 3.53191495(3.69016695)	c-index: 0.78853194(0.77376151)	lr: 0.00103275  
flag:  5
Epoch: 209	Loss: 3.55228353(3.68510342)	c-index: 0.77556173(0.77315041)	lr: 0.00103246  
flag:  6
Epoch: 210	Loss: 3.51976466(3.67939448)	c-index: 0.79067786(0.77585961)	lr: 0.00103217  
flag:  7
Epoch: 211	Loss: 3.48963046(3.67103100)	c-index: 0.78952600(0.77629756)	lr: 0.00103188  
flag:  8
Epoch: 212	Loss: 3.52615905(3.66008139)	c-index: 0.77639801(0.77726513)	lr: 0.00103159  
flag:  9
Epoch: 213	Loss: 3.48776269(3.65024543)	c-index: 0.78854772(0.77680681)	lr: 0.0010313  
flag:  10
Epoch: 214	Loss: 3.45969486(3.63560152)	c-index: 0.78891063(0.77707162)	lr: 0.00103101  
flag:  11
Epoch: 215	Loss: 3.47973514(3.62448597)	c-index: 0.78709606(0.77665404)	lr: 0.00103072  
flag:  12
Epoch: 216	Loss: 3.50359726(3.61832619)	c-index: 0.76723050(0.77140878)	lr: 0.00103043  
flag:  13
Epoch: 217	Loss: 3.45204592(3.60911965)	c-index: 0.78469768(0.77000326)	lr: 0.00103014  
flag:  14
Epoch: 218	Loss: 3.50957727(3.60025716)	c-index: 0.76327001(0.77319115)	lr: 0.00102985  
flag:  15
Epoch: 219	Loss: 3.44818282(3.58482814)	c-index: 0.78081608(0.77323189)	lr: 0.00102956  
flag:  16
Epoch: 220	Loss: 3.42919898(3.56939030)	c-index: 0.79075675(0.77221340)	lr: 0.00102927  
flag:  17
Epoch: 221	Loss: 3.41676664(3.55326748)	c-index: 0.78621245(0.77295690)	lr: 0.00102898  
flag:  18
Epoch: 222	Loss: 3.38551235(3.53381467)	c-index: 0.79744698(0.77408743)	lr: 0.00102869  
flag:  19
Epoch: 223	Loss: 3.41622019(3.51470518)	c-index: 0.77057561(0.77647071)	lr: 0.0010284  
flag:  20
Epoch: 224	Loss: 3.36871171(3.49529171)	c-index: 0.78654380(0.77949564)	lr: 0.00102811  
flag:  21
Epoch: 225	Loss: 3.37880731(3.47605586)	c-index: 0.77543550(0.78171596)	lr: 0.00102782  
Epoch: 226	Loss: 3.35486627(3.45764279)	c-index: 0.78846882(0.78271409)	lr: 0.00102753  
Epoch: 227	Loss: 3.35400748(3.44215584)	c-index: 0.77661891(0.78348814)	lr: 0.00102724  
flag:  1
Epoch: 228	Loss: 3.39581347(3.42969751)	c-index: 0.75441808(0.78156319)	lr: 0.00102695  
flag:  2
Epoch: 229	Loss: 3.32803941(3.41784024)	c-index: 0.79353383(0.78305019)	lr: 0.00102667  
flag:  3
Epoch: 230	Loss: 3.35045481(3.41098928)	c-index: 0.78600732(0.77594109)	lr: 0.00102638  
flag:  4
Epoch: 231	Loss: 3.31674814(3.41017389)	c-index: 0.79384941(0.77558462)	lr: 0.00102609  
flag:  5
Epoch: 232	Loss: 3.30571556(3.41248131)	c-index: 0.79141946(0.77165322)	lr: 0.0010258  
flag:  6
Epoch: 233	Loss: 3.27549767(3.41255641)	c-index: 0.78979424(0.77073658)	lr: 0.00102552  
flag:  7
Epoch: 234	Loss: 3.29097462(3.41060185)	c-index: 0.79012560(0.77049214)	lr: 0.00102523  
flag:  8
Epoch: 235	Loss: 3.25134277(3.40422058)	c-index: 0.80700896(0.77250876)	lr: 0.00102494  
flag:  9
Epoch: 236	Loss: 3.28281665(3.39628148)	c-index: 0.77672936(0.77517722)	lr: 0.00102465  
flag:  10
Epoch: 237	Loss: 3.26127958(3.38418317)	c-index: 0.79007826(0.77166341)	lr: 0.00102437  
flag:  11
Epoch: 238	Loss: 3.25314808(3.37013173)	c-index: 0.78969957(0.77128656)	lr: 0.00102408  
flag:  12
Epoch: 239	Loss: 3.24028587(3.35562086)	c-index: 0.78678048(0.77245783)	lr: 0.00102379  
flag:  13
Epoch: 240	Loss: 3.22363138(3.34255767)	c-index: 0.79934044(0.77291616)	lr: 0.00102351  
flag:  14
Epoch: 241	Loss: 3.22192144(3.33244872)	c-index: 0.79501704(0.77349670)	lr: 0.00102322  
flag:  15
Epoch: 242	Loss: 3.18956757(3.32128644)	c-index: 0.80571510(0.77476982)	lr: 0.00102294  
flag:  16
Epoch: 243	Loss: 3.21079230(3.30851388)	c-index: 0.78728541(0.77575776)	lr: 0.00102265  
flag:  17
Epoch: 244	Loss: 3.17954135(3.29931140)	c-index: 0.79863040(0.77617534)	lr: 0.00102236  
flag:  18
Epoch: 245	Loss: 3.23201752(3.29438543)	c-index: 0.77824413(0.77225414)	lr: 0.00102208  
flag:  19
Epoch: 246	Loss: 3.15888786(3.29269576)	c-index: 0.79186127(0.77193840)	lr: 0.00102179  
flag:  20
Epoch: 247	Loss: 3.16027093(3.28541327)	c-index: 0.79440167(0.77015603)	lr: 0.00102151  
flag:  21
Epoch: 248	Loss: 3.16313648(3.28315687)	c-index: 0.79320247(0.77072639)	lr: 0.00102122  
flag:  22
Epoch: 249	Loss: 3.15474749(3.27795839)	c-index: 0.79343916(0.77062454)	lr: 0.00102094  
flag:  23
Epoch: 250	Loss: 3.12458658(3.27800846)	c-index: 0.79795191(0.76790516)	lr: 0.00102065  
flag:  24
Epoch: 251	Loss: 3.08647418(3.27548409)	c-index: 0.81332050(0.76609223)	lr: 0.00102037  
flag:  25
Epoch: 252	Loss: 3.09196591(3.27232552)	c-index: 0.79937200(0.76538947)	lr: 0.00102008  
flag:  26
Epoch: 253	Loss: 3.06626177(3.26577759)	c-index: 0.80931267(0.76532836)	lr: 0.0010198  
flag:  27
Epoch: 254	Loss: 3.08170867(3.25729990)	c-index: 0.79842527(0.76167196)	lr: 0.00101951  
flag:  28
Epoch: 255	Loss: 3.11559486(3.25345135)	c-index: 0.80304847(0.76202844)	lr: 0.00101923  
flag:  29
Epoch: 256	Loss: 3.09553123(3.24897885)	c-index: 0.79990848(0.76357655)	lr: 0.00101895  
flag:  30
Epoch: 257	Loss: 3.09026122(3.24024320)	c-index: 0.78318291(0.76481912)	lr: 0.00101866  
flag:  31
Epoch: 258	Loss: 3.04368472(3.23105860)	c-index: 0.80833439(0.77157174)	lr: 0.00101838  
flag:  32
Epoch: 259	Loss: 3.05324435(3.22312689)	c-index: 0.79435433(0.77221340)	lr: 0.0010181  
flag:  33
Epoch: 260	Loss: 3.04801106(3.21713924)	c-index: 0.79790457(0.77097083)	lr: 0.00101781  
flag:  34
Epoch: 261	Loss: 3.00346303(3.21237755)	c-index: 0.81306804(0.76995233)	lr: 0.00101753  
flag:  35
Epoch: 262	Loss: 3.03609443(3.21142626)	c-index: 0.79478036(0.77236617)	lr: 0.00101725  
flag:  36
Epoch: 263	Loss: 3.04269767(3.19896126)	c-index: 0.78185749(0.77214210)	lr: 0.00101696  
flag:  37
Epoch: 264	Loss: 3.03528190(3.18247437)	c-index: 0.78947867(0.77011529)	lr: 0.00101668  
flag:  38
Epoch: 265	Loss: 3.02462173(3.16558671)	c-index: 0.79179816(0.76902550)	lr: 0.0010164  
flag:  39
Epoch: 266	Loss: 3.04636455(3.14615083)	c-index: 0.78375095(0.77163285)	lr: 0.00101612  
flag:  40
Epoch: 267	Loss: 3.02012467(3.12960768)	c-index: 0.77704494(0.76934124)	lr: 0.00101583  
flag:  41
Epoch: 268	Loss: 2.99561691(3.11596560)	c-index: 0.79736809(0.77070602)	lr: 0.00101555  
flag:  42
Epoch: 269	Loss: 2.95912600(3.10158086)	c-index: 0.80219642(0.76961623)	lr: 0.00101527  
flag:  43
Epoch: 270	Loss: 2.99175429(3.08912659)	c-index: 0.79255554(0.77144952)	lr: 0.00101499  
flag:  44
Epoch: 271	Loss: 2.99681759(3.07993865)	c-index: 0.79435433(0.77132730)	lr: 0.00101471  
flag:  45
Epoch: 272	Loss: 2.94600344(3.06844640)	c-index: 0.80259089(0.77249857)	lr: 0.00101443  
flag:  46
Epoch: 273	Loss: 2.96974826(3.05546451)	c-index: 0.79414920(0.77550314)	lr: 0.00101415  
flag:  47
Epoch: 274	Loss: 2.94907928(3.04439569)	c-index: 0.79921421(0.77682718)	lr: 0.00101386  
flag:  48
Epoch: 275	Loss: 2.96838331(3.03375220)	c-index: 0.79111967(0.77608368)	lr: 0.00101358  
flag:  49
Epoch: 276	Loss: 2.93852663(3.02435827)	c-index: 0.79455945(0.77720403)	lr: 0.0010133  
flag:  50
flag is geq patience, best_c_index_ is:  0.7834881447078954
Epoch: 277	Loss: 2.90140057(3.01181340)	c-index: 0.80640937(0.78213355)	lr: 0.00101302  
stopping index is True
torch deepsurv test ci:  0.7611558156547183
ci_cph 0.7867593269934162
ci_rsf 0.7670080468178493
ci_pytorch_val 0.7834881447078954
ci_pytorch_test 0.7611558156547183
ci_theano 0.7772494513533285
